<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/minidump.net\/",
  "author": {
    "@type": "Person",
    "name": "Kevin Gosse",
    
    "image": "https://minidump.net/images/profile.png"
    
  },
  "name":"minidump.net",
  "description":"",
  "url":"https:\/\/minidump.net\/tags\/cpp\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.121.1 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Kevin Gosse">
<meta name="keywords" content="">
<meta name="description" content="">


<meta property="og:description" content="">
<meta property="og:type" content="website">
<meta property="og:title" content="cpp">
<meta name="twitter:title" content="cpp">
<meta property="og:url" content="https://minidump.net/tags/cpp/">
<meta property="twitter:url" content="https://minidump.net/tags/cpp/">
<meta property="og:site_name" content="minidump.net">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:locale" content="en-us">


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@kookiz">


  <meta name="twitter:creator" content="@kookiz">






  <meta property="og:image" content="https://minidump.net/images/profile.png">
  <meta property="twitter:image" content="https://minidump.net/images/profile.png">






    <title>cpp</title>

    <link rel="icon" href="/favicon.png">
    
      <link rel="alternate" type="application/rss+xml" title="RSS" href="/tags/cpp/index.xml">
    

    

    <link rel="canonical" href="https://minidump.net/tags/cpp/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://minidump.net/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/" aria-label="Go to homepage">minidump.net</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://minidump.net/images/profile.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Kevin Gosse</h4>
        
          <h5 class="sidebar-profile-bio">Kevin Gosse has been using Microsoft .NET technologies for more than 15 years, across client, server, and mobile applications. Passionate about debugging. He is Microsoft MVP and is currently employed at Datadog, where he works on the performance of the .NET APM.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/#about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/kookiz" target="_blank" rel="noopener" title="Twitter">
    
      <i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/kevingosse" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.buymeacoffee.com/kevingosse" target="_blank" rel="noopener" title="Buy me a coffee">
    
      <i class="sidebar-button-icon fas fa-lg fa-coffee" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Buy me a coffee</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
        

      
      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        
          <section class="postShorten-group main-content-wrap">
            
            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/memory-alignment-of-doubles-in-c-1d13e3ce741/" aria-label="Open the post: Memory alignment of doubles in C#">
      
          Memory alignment of doubles in C#
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-09-30T00:00:00Z">
        
  
  
  
  
    September 30 2023
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        A while ago, I mentioned on Twitter an interesting quirk of objects in .NET: when running in 64 bits, objects are aligned on a 8-bytes boundary despite having a 32 bits header, and therefore 32 bits are &ldquo;lost&rdquo; before each object:
It bothers me so much that on #dotnet on 64-bit, 4 bytes are wasted for *every class instance* because objects are aligned on a 8 bytes boundary and the header has a fixed size of 4 bytes.
      
      <p>
        
          <a href="https://minidump.net/memory-alignment-of-doubles-in-c-1d13e3ce741/" class="postShorten-excerpt_link link" aria-label="Open the post: Memory alignment of doubles in C#">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/memory-alignment-of-doubles-in-c-1d13e3ce741/" aria-label="Open the post: Memory alignment of doubles in C#">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/memory-alignment-of-doubles-in-c-1d13e3ce741-1.webp"/>
      </div>
    </a>
  
</article>

            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/verificationexception-in-net-framework-when-using-structs-6269eb3df448/" aria-label="Open the post: VerificationException in .NET Framework when using structs">
      
          VerificationException in .NET Framework when using structs
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-05-01T00:00:00Z">
        
  
  
  
  
    May 01 2023
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        Consider the following code:
private static readonly ReadonlyStruct Struct; public static void Read() { Console.WriteLine(Struct.Value); } public struct ReadonlyStruct { public ReadonlyStruct(int value) { Value = value; } public int Value; } This looks pretty straightforward, right? We store a struct in a readonly field, and read it.
Yet, what happens if we try to run this program in .NET Framework under partial trust?
static void Main(string[] args) { var permissionSet = new PermissionSet(PermissionState.
      
      <p>
        
          <a href="https://minidump.net/verificationexception-in-net-framework-when-using-structs-6269eb3df448/" class="postShorten-excerpt_link link" aria-label="Open the post: VerificationException in .NET Framework when using structs">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/verificationexception-in-net-framework-when-using-structs-6269eb3df448/" aria-label="Open the post: VerificationException in .NET Framework when using structs">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/verificationexception-in-net-framework-when-using-structs-6269eb3df448-2.webp"/>
      </div>
    </a>
  
</article>

            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/an-unconventional-way-of-investigating-a-nullreferenceexception-5628cca01d6a/" aria-label="Open the post: An unconventional way of investigating a NullReferenceException">
      
          An unconventional way of investigating a NullReferenceException
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2021-03-16T00:00:00Z">
        
  
  
  
  
    March 16 2021
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        The crash This one started when trying to understand why an integration test was failing, only on Linux with ARM64.
As I had no ARM64 dev environment available, I first tried adding more and more traces and let the test run in the CI, without much success.
Eventually, I realized this was leading nowhere, and took the time to setup an ARM64 VM to investigate further. After running the test with LLDB (see my previous article to learn how to fetch the symbols for the CLR), I found out that the process was raising two segmentations faults, and the second one caused the crash:
      
      <p>
        
          <a href="https://minidump.net/an-unconventional-way-of-investigating-a-nullreferenceexception-5628cca01d6a/" class="postShorten-excerpt_link link" aria-label="Open the post: An unconventional way of investigating a NullReferenceException">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/an-unconventional-way-of-investigating-a-nullreferenceexception-5628cca01d6a/" aria-label="Open the post: An unconventional way of investigating a NullReferenceException">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/an-unconventional-way-of-investigating-a-nullreferenceexception-5628cca01d6a-1.webp"/>
      </div>
    </a>
  
</article>

            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-2-of-2-a703e484113c/" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 2 of 2)">
      
          AccessViolation in ObjectNative::IsLockHeld (part 2 of 2)
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-11-25T00:00:00Z">
        
  
  
  
  
    November 25 2020
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        This is the second part of an investigation where I tried to understand why an application was randomly crashing with an AccessViolationException.
If you haven&rsquo;t read it, you can find part 1 of the investigation here.
As a reminder, here is what we uncovered so far:
The server runs Orchard, with the Datadog .NET tracer, and crashes about once or twice per day
The crash dump indicated an access violation in method clr!
      
      <p>
        
          <a href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-2-of-2-a703e484113c/" class="postShorten-excerpt_link link" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 2 of 2)">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-2-of-2-a703e484113c/" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 2 of 2)">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/accessviolation-in-objectnative-islockheld-part-2-of-2-a703e484113c-1.webp"/>
      </div>
    </a>
  
</article>

            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-1-of-2-7fae4b839f9a/" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 1 of 2)">
      
          AccessViolation in ObjectNative::IsLockHeld (part 1 of 2)
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-11-05T00:00:00Z">
        
  
  
  
  
    November 05 2020
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        This is a two parts article. Part two is available here.
Symptoms To monitor the stability of the Datadog .NET tracer, we have a reliability environment where we continuously run mainstream applications such as Orchard. This story starts when, while preparing a release, we discovered that the latest version of our tracer was crashing the app with the message:
Application: w3wp.exe Framework Version: v4.0.30319 Description: The process was terminated due to an internal error in the .
      
      <p>
        
          <a href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-1-of-2-7fae4b839f9a/" class="postShorten-excerpt_link link" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 1 of 2)">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/accessviolation-in-objectnative-islockheld-part-1-of-2-7fae4b839f9a/" aria-label="Open the post: AccessViolation in ObjectNative::IsLockHeld (part 1 of 2)">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/accessviolation-in-objectnative-islockheld-part-1-of-2-7fae4b839f9a-3.webp"/>
      </div>
    </a>
  
</article>

            
              
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-bottom">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://minidump.net/investigating-an-invalidprogramexception-from-a-memory-dump-part-2-of-3-daaecd8f3cf4/" aria-label="Open the post: Investigating an InvalidProgramException from a memory dump (part 2 of 3)">
      
          Investigating an InvalidProgramException from a memory dump (part 2 of 3)
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-09-01T00:00:00Z">
        
  
  
  
  
    September 01 2020
  

      </time>
    
    
  </div>

    </div>
    <div class="postShorten-excerpt">
      
        In this series of article, we&rsquo;re retracing how I debugged an InvalidProgramException, caused by a bug in the Datadog profiler, from a memory dump sent by a customer.
Part 1: Preliminary exploration
Part 2: Finding the generated IL
Part 3: Identifying the error and fixing the bug
Let&rsquo;s start with a quick reminder. The profiler works by rewriting the IL of interesting methods to inject instrumentation code. The InvalidProgramException is thrown by the JIT when trying to compile the IL emitted by the profiler, which must be somehow invalid.
      
      <p>
        
          <a href="https://minidump.net/investigating-an-invalidprogramexception-from-a-memory-dump-part-2-of-3-daaecd8f3cf4/" class="postShorten-excerpt_link link" aria-label="Open the post: Investigating an InvalidProgramException from a memory dump (part 2 of 3)">Continue reading</a>
        
        
      </p>
    </div>
  </div>
  
    <a href="https://minidump.net/investigating-an-invalidprogramexception-from-a-memory-dump-part-2-of-3-daaecd8f3cf4/" aria-label="Open the post: Investigating an InvalidProgramException from a memory dump (part 2 of 3)">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://minidump.net/images/investigating-an-invalidprogramexception-from-a-memory-dump-part-2-of-3-daaecd8f3cf4-1.webp"/>
      </div>
    </a>
  
</article>

            
            

          </section>
        
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Kevin Gosse. All Rights Reserved
  </span>
</footer>

      </div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://minidump.net/images/profile.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Kevin Gosse</h4>
    
      <div id="about-card-bio">Kevin Gosse has been using Microsoft .NET technologies for more than 15 years, across client, server, and mobile applications. Passionate about debugging. He is Microsoft MVP and is currently employed at Datadog, where he works on the performance of the .NET APM.</div>
    
    
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://minidump.net/images/code.png');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://minidump.net/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

